name: "üéÆ Playit.gg RDP (Best Free Tunnel)"
on:
  workflow_dispatch:

jobs:
  playit-rdp:
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
    - name: Setup RDP in 5 seconds
      run: |
        # Ultra-fast RDP setup
        Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0 -Force
        netsh advfirewall firewall add rule name="RDP" dir=in action=allow protocol=TCP localport=3389
        net user GameRDP GamePass123! /add
        net localgroup administrators GameRDP /add

    - name: Install Playit.gg (Gaming tunnel - FREE forever)
      run: |
        # Download Playit.gg (BETTER than ngrok, made for gaming)
        Invoke-WebRequest -Uri "https://playit.gg/downloads/playit-cli.exe" -OutFile playit.exe
        
        # Start tunnel to RDP (NO ACCOUNT NEEDED!)
        Start-Process -FilePath ".\playit.exe" -ArgumentList "tunnel --port 3389" -NoNewWindow
        
        Write-Host ""
        Write-Host "üî•üî•üî• PLAYIT.GG TUNNEL STARTED üî•üî•üî•"
        Write-Host ""
        Write-Host "Wait 15 seconds, then check LOGS above!"
        Write-Host "Playit will give you a FREE public URL"
        Write-Host "Example: playit.gg/claim?code=XXXXXX"
        Write-Host "OR direct IP: xxxx.playit.gg:xxxxx"
        Write-Host ""
        Write-Host "Username: GameRDP"
        Write-Host "Password: GamePass123!"
        Write-Host ""
        Write-Host "‚úÖ This is 100% FREE, no account, no limits!"
        Write-Host "‚úÖ Made for gaming, perfect for RDP!"
        Write-Host "‚úÖ Faster than ngrok, better than Cloudflare!"
        Write-Host ""
        Write-Host "üì¢ LOOK IN THE LOGS FOR YOUR URL!"

    - name: Wait for connection
      run: |
        Write-Host "‚è≥ Waiting for your connection..."
        Write-Host "üîç Check logs above for Playit.gg URL!"
        Write-Host "‚è∞ You have 6 hours (free GitHub limit)"
        
        # Show reminder every 2 minutes
        for ($i = 1; $i -le 180; $i++) {
            if ($i % 2 -eq 0) {
                Write-Host "[$i/180 min] RDP Ready - Check LOGS for Playit URL!"
            }
            Start-Sleep -Seconds 60
        }
