name: "ðŸ†“ Ultra Simple RDP"
on:
  workflow_dispatch:

jobs:
  simple-rdp:
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
      - name: Setup RDP
        run: |
          # One-line RDP enable
          reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
          
          # Create user
          net user RDPUser Pass1234! /add
          net localgroup administrators RDPUser /add
          net localgroup "Remote Desktop Users" RDPUser /add
          
          # Allow firewall
          netsh advfirewall firewall add rule name="RDP" dir=in action=allow protocol=TCP localport=3389

      - name: Get Public IP
        run: |
          $ip = (Invoke-WebRequest -Uri "https://api.ipify.org" -UseBasicParsing).Content
          Write-Host "Public IP: $ip"
          Write-Host ""
          Write-Host "================================"
          Write-Host "CONNECT USING:"
          Write-Host "Computer: $ip"
          Write-Host "Username: RDPUser"
          Write-Host "Password: Pass1234!"
          Write-Host ""
          Write-Host "NOTE: This only works if GitHub's firewall"
          Write-Host "allows inbound RDP (often blocked)"
          Write-Host "================================"

      - name: Wait for connection attempt
        run: |
          Write-Host "Waiting 55 minutes for you to try connecting..."
          Write-Host "If connection fails, GitHub blocks inbound RDP"
          Write-Host "Try the ngrok method instead"
          Start-Sleep -Seconds 3300  # 55 minutes
